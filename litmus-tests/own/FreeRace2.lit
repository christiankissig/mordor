//TEMP FIX: globals not supported in expressions yet, thus using pointers
//directly
x := 0;
//p := malloc 1;
rp := malloc(1);
{
  //rp := p;
  *rp := 1;
  x.store(1, rel);
} ||| {
  r2 := x.load(acq);
  if (r2 = 1) {
    //free(p);
    free(rp);
  }
}
%%
forbid (ub) []
